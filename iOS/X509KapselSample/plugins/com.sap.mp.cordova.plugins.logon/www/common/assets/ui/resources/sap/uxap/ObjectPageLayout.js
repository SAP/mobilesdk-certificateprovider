/*!
 * SAP.${maven.build.timestamp} UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.uxap.ObjectPageLayout");jQuery.sap.require("sap.uxap.library");jQuery.sap.require("sap.ui.core.Control");sap.ui.core.Control.extend("sap.uxap.ObjectPageLayout",{metadata:{publicMethods:["scrollToSection","getScrollDelegate","getScrollingSectionId"],library:"sap.uxap",properties:{"showAnchorBar":{type:"boolean",group:"",defaultValue:true},"showAnchorBarPopover":{type:"boolean",group:"",defaultValue:true},"height":{type:"sap.ui.core.CSSSize",group:"",defaultValue:'100%'},"enableLazyLoading":{type:"boolean",group:"",defaultValue:false},"subSectionLayout":{type:"sap.uxap.ObjectPageSubSectionLayout",group:"",defaultValue:sap.uxap.ObjectPageSubSectionLayout.TitleOnTop}},defaultAggregation:"sections",aggregations:{"sections":{type:"sap.uxap.ObjectPageSection",multiple:true,singularName:"section"},"headerTitle":{type:"sap.uxap.ObjectPageHeader",multiple:false},"headerContent":{type:"sap.ui.core.Control",multiple:true,singularName:"headerContent"},"_anchorBar":{type:"sap.uxap.AnchorBar",multiple:false,visibility:"hidden"}},events:{"toggleAnchorBar":{}}}});sap.uxap.ObjectPageLayout.M_EVENTS={'toggleAnchorBar':'toggleAnchorBar'};jQuery.sap.require("sap.ui.core.CustomData");jQuery.sap.require("sap.uxap.ObjectPageSubSection");jQuery.sap.require("sap.ui.core.delegate.ScrollEnablement");jQuery.sap.require("sap.uxap.AnchorBar");jQuery.sap.require("sap.uxap.ObjectPageSubSectionLayout");
sap.uxap.ObjectPageLayout.prototype.init=function(){this._oScroller=null;this._bFirstRendering=true;this._oDefaultAnchorBar=new sap.uxap.AnchorBar({showPopover:this.getShowAnchorBarPopover()});this._bInternalAnchorBarVisible=true;this.setAggregation("_anchorBar",this._oDefaultAnchorBar);this._$opWrapper=[];this._$anchorBar=[];this._$headerTitle=[];this._$stickyAnchorBar=[];this._bStickyAnchorBar=false;this._bDomReady=false;this._$headerContent=[];this._bMobileScenario=false;this._oSectionInfo={};this._aSectionBases=[];this._sScrolledSectionId="";this._iScrollToSectionDuration=600;this._$spacer=[];this.iHeaderContentHeight=0;this.iHeaderTitleHeight=0;this.iHeaderTitleHeightStickied=0;this.iAnchorBarHeight=0;this.iTotalHeaderSize=0;this._iResizeId=sap.ui.core.ResizeHandler.register(this,jQuery.proxy(this._onUpdateScreenSize,this));this._iPreviousScrollTop=0;this._iScrollProgress=0;this._iPreviousScrollTimestamp=0;this.setLazyLoadingParameters()};
sap.uxap.ObjectPageLayout.HEADER_CALC_DELAY=350;sap.uxap.ObjectPageLayout.DOM_CALC_DELAY=200;
sap.uxap.ObjectPageLayout.prototype.exit=function(){if(this._oScroller){this._oScroller.destroy();this._oScroller=null}if(this._oDefaultAnchorBar){this._oDefaultAnchorBar.destroy();this._oDefaultAnchorBar=null}if(this._iResizeId){sap.ui.core.ResizeHandler.deregister(this._iResizeId)}};
sap.uxap.ObjectPageLayout.prototype._applyUxRules=function(i){var o,s,S,v,V,a,b,f,F;o=this;s=o.getSections()||[];V=0;b=this.getShowAnchorBar();f=null;this._cleanMemory();jQuery.each(s,function(I,c){if(!c.getVisible()){return true}o._registerSectionBaseInfo(c);S=c.getSubSections()||[];v=0;F=null;jQuery.each(S,function(I,d){if(!d.getVisible()){return true}o._registerSectionBaseInfo(d);a=0;jQuery.each(d.getBlocks()||[],function(I,B){if(B.getVisible&&!B.getVisible()){return true}a++;return true});jQuery.each(d.getMoreBlocks()||[],function(I,m){if(m.getVisible&&!m.getVisible()){return true}a++;return true});if(a==0){d._setInternalVisible(false,i);jQuery.sap.log.info("ObjectPageLayout :: noVisibleBlock UX rule matched","subSection "+d.getTitle()+" forced to hidden")}else{d._setInternalVisible(true,i);d._setInternalTitleVisible(true,i);v++;if(!F){F=d}}return true});if(v==0){c._setInternalVisible(false,i);jQuery.sap.log.info("ObjectPageLayout :: noVisibleSubSection UX rule matched","section "+c.getTitle()+" forced to hidden")}else{c._setInternalVisible(true,i);c._setInternalTitleVisible(true,i);if(!f){f=c}if(o.getSubSectionLayout()===sap.uxap.ObjectPageSubSectionLayout.TitleOnTop&&v==1&&F.getTitle().trim()!==""){jQuery.sap.log.info("ObjectPageLayout :: TitleOnTop.sectionGetSingleSubSectionTitle UX rule matched","section "+c.getTitle()+" is taking its single subsection title "+F.getTitle());c._setInternalTitle(F.getTitle(),i);F._setInternalTitleVisible(false,i)}else{c._setInternalTitle("",i)}V++}return true});if(V<=1){b=false;jQuery.sap.log.info("ObjectPageLayout :: notEnoughVisibleSection UX rule matched","anchorBar forced to hidden")}else if(f&&b){f._setInternalTitleVisible(false,i);jQuery.sap.log.info("ObjectPageLayout :: firstSectionTitleHidden UX rule matched","section "+f.getTitle()+" title forced to hidden")}o._setInternalAnchorBarVisible(b,i);if(b){this._buildAnchorBar()}};
sap.uxap.ObjectPageLayout.prototype.setLazyLoadingParameters=function(){this.LAZY_LOADING_DELAY=200;this.LAZY_LOADING_EXTRA_PAGE_SIZE=0.5;var $=jQuery("html");if($.hasClass("sapUiMedia-Std-Phone")||sap.ui.Device.system.phone){this.NUMBER_OF_SUBSECTIONS_TO_PRELOAD={"FirstRendering":1,"ScrollToSection":1}}else if(sap.ui.Device.system.tablet){this.NUMBER_OF_SUBSECTIONS_TO_PRELOAD={"FirstRendering":2,"ScrollToSection":1}}else if($.hasClass("sapUiMedia-Std-Tablet")){this.NUMBER_OF_SUBSECTIONS_TO_PRELOAD={"FirstRendering":2,"ScrollToSection":2}}else{this.NUMBER_OF_SUBSECTIONS_TO_PRELOAD={"FirstRendering":3,"ScrollToSection":3}}this.LAZY_LOADING_FAST_SCROLLING_THRESHOLD=5};
sap.uxap.ObjectPageLayout.prototype._preLoad=function(i){var s,t;if(i){s=this.NUMBER_OF_SUBSECTIONS_TO_PRELOAD.ScrollToSection;t=false}else{s=this.NUMBER_OF_SUBSECTIONS_TO_PRELOAD.FirstRendering;t=true}jQuery.each(this._aSectionBases,jQuery.proxy(function(I,S){if(!t&&i){t=S.getId()==i}if(t&&S instanceof sap.uxap.ObjectPageSubSection){if(S.getVisible()&&S._getInternalVisible()){S.connectToModels();s--}}return s>0},this))};
sap.uxap.ObjectPageLayout.prototype.setShowAnchorBarPopover=function(v,s){this._oDefaultAnchorBar.setShowPopover(v);return this.setProperty("showAnchorBarPopover",v,true)};
sap.uxap.ObjectPageLayout.prototype._getInternalAnchorBarVisible=function(){return this._bInternalAnchorBarVisible};
sap.uxap.ObjectPageLayout.prototype._setInternalAnchorBarVisible=function(v,i){if(v!=this._bInternalAnchorBarVisible){this._bInternalAnchorBarVisible=v;if(i===true){this.invalidate()}}};
sap.uxap.ObjectPageLayout.prototype._adjustLayout=function(e,i,n){if(this._bDomReady){if(this._iLayoutTimer){jQuery.sap.log.debug("ObjectPageLayout :: _adjustLayout","delayed by "+sap.uxap.ObjectPageLayout.DOM_CALC_DELAY+" ms because of dom modifications");jQuery.sap.clearDelayedCall(this._iLayoutTimer)}if(i){this._updateDomPositions();this._iLayoutTimer=undefined}else{this._bNeedLazyLoading=this._bNeedLazyLoading!==undefined||n;this._iLayoutTimer=jQuery.sap.delayedCall(sap.uxap.ObjectPageLayout.DOM_CALC_DELAY,this,function(){jQuery.sap.log.debug("ObjectPageLayout :: _adjustLayout","re-evaluating dom positions");this._updateDomPositions();if(this._bNeedLazyLoading){this._lazyLoading()}this._bNeedLazyLoading=undefined;this._iLayoutTimer=undefined})}}};
sap.uxap.ObjectPageLayout.prototype._adjustLayoutAndUxRules=function(){jQuery.sap.log.debug("ObjectPageLayout :: _adjustLayout","refreshing ux rules");this._applyUxRules(true);this._adjustLayout(null,false,true)};
sap.uxap.ObjectPageLayout.prototype.onBeforeRendering=function(){if(this._oScroller){this._oScroller.scrollTo(0,0,0);this._oScroller.destroy()}var e=(sap.ui.Device.os.blackberry&&sap.ui.Device.os.version>=10.0&&sap.ui.Device.os.version<11.0);this._oScroller=new sap.ui.core.delegate.ScrollEnablement(this,this.getId()+"-scroll",{horizontal:false,vertical:true,zynga:e,preventDefault:true,nonTouchScrolling:"scrollbar",scrollbarClass:"sapUxAPObjectPageScroll"});this._applyUxRules();if(!jQuery.isEmptyObject(this._oSectionInfo)&&this._bFirstRendering){if(!this.getEnableLazyLoading()){jQuery.each(this.getSections()||[],jQuery.proxy(function(i,s){s.connectToModels()},this))}else{this._preLoad()}this._bFirstRendering=false}this._bStickyAnchorBar=false};
sap.uxap.ObjectPageLayout.prototype._buildAnchorBarButton=function(s,i){var b=null,B,S,m;if(s.getVisible()&&s._getInternalVisible()){B=s.getCustomAnchorBarButton();if(!B){b=new sap.m.Button({ariaDescribedBy:s});if(s._getInternalTitle()!=""){b.setText(s._getInternalTitle())}else{S=s.getBindingInfo("title");if(S&&S.parts&&S.parts.length>0){m=S.parts[0].model;b.setBindingContext(s.getBindingContext(m),m);b.bindProperty("text",{path:S.parts[0].path,model:m})}else{b.setText(s.getTitle())}}}else{b=B.clone()}this._oSectionInfo[s.getId()].buttonId=b.getId();b.addCustomData(new sap.ui.core.CustomData({key:"sectionId",value:s.getId()}));b.addCustomData(new sap.ui.core.CustomData({key:"phoneVisibility",value:s._getInternalTitleVisible()}));if(!i){b.addCustomData(new sap.ui.core.CustomData({key:"secondLevel",value:true}))}}return b};
sap.uxap.ObjectPageLayout.prototype._cleanMemory=function(){var a=this.getAggregation("_anchorBar");jQuery.each(this._oSectionInfo,function(s,i){var b=sap.ui.getCore().byId(i.buttonId);if(a&&b){a.destroyContent(b)}});this._oSectionInfo={};this._aSectionBases=[]};
sap.uxap.ObjectPageLayout.prototype._buildAnchorBar=function(){var s=this.getSections()||[],a=this.getAggregation("_anchorBar");if(a&&this.getShowAnchorBar()){a.removeAllContent();jQuery.each(s,jQuery.proxy(function(i,S){if(!S.getVisible()||!S._getInternalVisible()){return true}var b,c=S.getSubSections()||[];b=this._buildAnchorBarButton(S,true);if(b){a.addContent(b);jQuery.each(c,jQuery.proxy(function(i,o){if(!o.getVisible()||!o._getInternalVisible()){return true}var b=this._buildAnchorBarButton(o,false);if(b){a.addContent(b)}return true},this))}return true},this))}};
sap.uxap.ObjectPageLayout.prototype._registerSectionBaseInfo=function(s){this._oSectionInfo[s.getId()]={$dom:[],positionTop:0,positionTopMobile:0,realTop:0.0,buttonId:"",isSection:(s instanceof sap.uxap.ObjectPageSection)};this._aSectionBases.push(s)};
sap.uxap.ObjectPageLayout.prototype.scrollToSection=function(i,d){this._adjustLayout(null,true);var D=d||this._iScrollToSectionDuration,s=this._bMobileScenario||!this.getShowAnchorBarPopover()?this._oSectionInfo[i].positionTopMobile:this._oSectionInfo[i].positionTop;if(this._sCurrentScrollId!=i){this._sCurrentScrollId=i;if(this._iCurrentScrollTimeout){clearTimeout(this._iCurrentScrollTimeout);this._$contentContainer.parent().stop(true,false)}this._iCurrentScrollTimeout=jQuery.sap.delayedCall(d,this,function(){this._sCurrentScrollId=undefined;this._iCurrentScrollTimeout=undefined});if(this.getEnableLazyLoading()){if(sap.ui.Device.system.desktop){jQuery.sap.delayedCall(50,this,function(){this._preLoad(i)})}else{this._preLoad(i)}}this._scrollTo(s,D)}};
sap.uxap.ObjectPageLayout.prototype.getScrollingSectionId=function(){return this._sScrolledSectionId};
sap.uxap.ObjectPageLayout.prototype._scrollTo=function(y,t){if(this._oScroller){jQuery.sap.log.debug("ObjectPageLayout :: scrolling to "+y);this._oScroller.scrollTo(0,y,t)}return this};
sap.uxap.ObjectPageLayout.prototype._updateDomPositions=function(){var l,L,s,p,P,h;this.iScreenHeight=this.$().height();h=this.iHeaderTitleHeightStickied-this.iHeaderTitleHeight;jQuery.each(this._aSectionBases,jQuery.proxy(function(i,S){var I=this._oSectionInfo[S.getId()],$=S.$(),a;if(I&&$.length>0){I.$dom=$;I.realTop=$.position().top;I.positionTop=Math.ceil(I.realTop)-this.iAnchorBarHeight-h;if(I.isSection){a=S.$("header")}else{a=S.$("headerTitle")}if(a.length>0){I.positionTopMobile=Math.ceil(a.position().top)+a.height()-this.iAnchorBarHeight-h}else{I.positionTopMobile=I.positionTop}if(this._bMobileScenario){if(P){this._oSectionInfo[P].positionBottom=I.positionTop}P=S.getId();L=S}else{if(I.isSection){if(P){this._oSectionInfo[P].positionBottom=I.positionTop;this._oSectionInfo[p].positionBottom=I.positionTop}P=S.getId();p=null}else{if(p){this._oSectionInfo[p].positionBottom=I.positionTop}p=S.getId();L=S}}}},this));if(L){l=this._$spacer.position().top-this._oSectionInfo[L.getId()].realTop;if(this._bMobileScenario){this._oSectionInfo[P].positionBottom=this._oSectionInfo[P].positionTop+l}else{this._oSectionInfo[p].positionBottom=this._oSectionInfo[p].positionTop+l;this._oSectionInfo[P].positionBottom=this._oSectionInfo[p].positionTop+l}if(l<this.iScreenHeight){s=this.iScreenHeight-l-this.iHeaderTitleHeightStickied-this.iAnchorBarHeight;if(this._bMobileScenario){s+=(this._oSectionInfo[L.getId()].positionTopMobile-this._oSectionInfo[L.getId()].positionTop)}this._$spacer.height(s+"px");jQuery.sap.log.debug("ObjectPageLayout :: bottom spacer is now "+s+"px")}}};
sap.uxap.ObjectPageLayout.prototype._initAnchorBarScroll=function(){this._adjustLayout(null,true);this._sScrolledSectionId="";this._onScroll({target:{scrollTop:0}})};
sap.uxap.ObjectPageLayout.prototype._setAsCurrentSection=function(s){var a,S;if(this._sScrolledSectionId!=s){jQuery.sap.log.debug("ObjectPageLayout :: current section is "+s);this._sScrolledSectionId=s;a=this.getAggregation("_anchorBar");if(a&&this._getInternalAnchorBarVisible()){S=sap.ui.getCore().byId(s);if(S&&S instanceof sap.uxap.ObjectPageSubSection&&(S.getTitle().trim()===""||!S._getInternalTitleVisible())){s=S.getParent().getId();jQuery.sap.log.debug("ObjectPageLayout :: current section is a subSection with an empty or hidden title, selecting parent "+s)}if(this._oSectionInfo[s]){a.setSelectedButton(this._oSectionInfo[s].buttonId)}}}};
sap.uxap.ObjectPageLayout.prototype._onUpdateScreenSize=function(e){if(!this._bDomReady){jQuery.sap.log.info("ObjectPageLayout :: cannot _onUpdateScreenSize before dom is ready");return}this._bMobileScenario=jQuery("html").hasClass("sapUiMedia-Std-Phone")||sap.ui.Device.system.phone;this.setLazyLoadingParameters();jQuery.sap.delayedCall(sap.uxap.ObjectPageLayout.HEADER_CALC_DELAY,this,function(){this._adjustHeaderHeights();this._adjustLayout(null,true);this._oScroller.scrollTo(0,this._$opWrapper.scrollTop(),0)})};
sap.uxap.ObjectPageLayout.prototype.onAfterRendering=function(){if(this.getParent().getHeight&&this.getParent().getHeight()==""){this.$().parent().css("height","100%")}this._$headerTitle=jQuery.sap.byId(this.getId()+"-headerTitle");this._$anchorBar=jQuery.sap.byId(this.getId()+"-anchorBar");this._$stickyAnchorBar=jQuery.sap.byId(this.getId()+"-stickyAnchorBar");this._$opWrapper=jQuery.sap.byId(this.getId()+"-opwrapper");this._$spacer=jQuery.sap.byId(this.getId()+"-spacer");this._$headerContent=jQuery.sap.byId(this.getId()+"-headerContent");this._bMobileScenario=jQuery("html").hasClass("sapUiMedia-Std-Phone")||sap.ui.Device.system.phone;this._$contentContainer=jQuery.sap.byId(this.getId()+"-scroll");this._$opWrapper.scroll(jQuery.proxy(this._onScroll,this));var r=0.0;if(sap.ui.Device.system.desktop){r=jQuery.position.scrollbarWidth()}if(r>0){if(sap.ui.getCore().getConfiguration().getRTL()){this._$headerTitle.css("left",r+"px")}else{this._$headerTitle.css("right",r+"px")}}if(this._bDomReady){this._adjustHeaderHeights();this._initAnchorBarScroll()}else{jQuery.sap.delayedCall(sap.uxap.ObjectPageLayout.HEADER_CALC_DELAY,this,function(){this._bDomReady=true;this._adjustHeaderHeights();this._initAnchorBarScroll()})}};
sap.uxap.ObjectPageLayout.prototype._onScroll=function(e){var s=Math.max(e.target.scrollTop,0),S,p,h=this.getHeaderTitle(),l=this._$contentContainer.height()-this.iScreenHeight,f=false,b=s>=(this.iHeaderContentHeight-(this.iHeaderTitleHeightStickied-this.iHeaderTitleHeight)),d,c,m,P;p=(this.iScreenHeight-(b?this.iAnchorBarHeight:0)-(b?this.iHeaderTitleHeightStickied:0));S=s+p;if(h||this.getShowAnchorBar()){this._toggleHeader(b)}else if(s==0&&(h||this.getShowAnchorBar())){this._toggleHeader(false)}m=l;this._adjustHeaderTitleBackgroundPosition(s);jQuery.sap.log.debug("ObjectPageLayout :: lazy loading : Scrolling at "+s,"----------------------------------------");jQuery.each(this._oSectionInfo,jQuery.proxy(function(i,I){if(I.isSection||this._bMobileScenario){if(!c){c=i}if(I.positionTop<=S&&s<=I.positionBottom){if(I.positionBottom-s<m){c=i;m=I.positionBottom-s}}}},this));if(c&&c!=this._sScrolledSectionId){jQuery.sap.log.debug("ObjectPageLayout :: closest id "+c,"----------------------------------------");this._setAsCurrentSection(c)}if(this.getEnableLazyLoading()){this._iScrollProgress=s-this._iPreviousScrollTop;P=Math.round(Math.abs(this._iScrollProgress)/p*100);if(P>=this.LAZY_LOADING_FAST_SCROLLING_THRESHOLD){f=true}this._iPreviousScrollTop=s;this._iPreviousScrollTimestamp=e.timeStamp||0;d=(s===0)?0:this.LAZY_LOADING_DELAY;if(f&&this._sLazyLoadingTimer){jQuery.sap.log.debug("ObjectPageLayout :: lazyLoading","delayed by "+d+" ms because of fast scroll");jQuery.sap.clearDelayedCall(this._sLazyLoadingTimer);this._sLazyLoadingTimer=null}if(!this._sLazyLoadingTimer){this._sLazyLoadingTimer=jQuery.sap.delayedCall(d,this,this._lazyLoading)}}};
sap.uxap.ObjectPageLayout.prototype._lazyLoading=function(){var s,S,p,b=this._iPreviousScrollTop>=(this.iHeaderContentHeight),e,E=-1,o={},t,O,i;p=(this.iScreenHeight-(b?this.iAnchorBarHeight:0)-(b?this.iHeaderTitleHeightStickied:0));s=this._$opWrapper.scrollTop();t=Date.now()-this._iPreviousScrollTimestamp;O=(t<(this.LAZY_LOADING_DELAY/2))&&(Math.abs(this._iScrollProgress)>5);if(O){if(this._iScrollProgress>=0){i=Math.round(Math.min(this._iScrollProgress*20,p/2))}else{i=-1*Math.round(Math.min(Math.abs(this._iScrollProgress)*20,p/2))}s+=i;jQuery.sap.log.debug("ObjectPageLayout :: lazyLoading","Visible page shifted from : "+i)}S=s+p;s+=16;jQuery.each(this._oSectionInfo,jQuery.proxy(function(I,a){if(!a.isSection&&!a.loaded){if(a.positionTop<=S&&s<a.positionBottom-1){o[I]=I}else if(a.positionTop>S&&a.positionTop<S+p*this.LAZY_LOADING_EXTRA_PAGE_SIZE&&(E==-1||a.positionTop<E)){E=a.positionTop;e=I}}},this));if(E!=-1&&jQuery.isEmptyObject(o)){jQuery.sap.log.debug("ObjectPageLayout :: lazyLoading","extra section added : "+e);o[e]=e}jQuery.each(o,jQuery.proxy(function(a,c){jQuery.sap.log.debug("ObjectPageLayout :: lazyLoading","connecting "+c);sap.ui.getCore().byId(c).connectToModels();this._oSectionInfo[c].loaded=true},this));if(O){this._sLazyLoadingTimer=jQuery.sap.delayedCall(this.LAZY_LOADING_DELAY,this,this._lazyLoading)}else{if(E){this._sLazyLoadingTimer=jQuery.sap.delayedCall(5*this.LAZY_LOADING_DELAY,this,this._lazyLoading)}else{this._sLazyLoadingTimer=null}}};
sap.uxap.ObjectPageLayout.prototype._toggleHeader=function(s){this._$headerTitle.toggleClass("sapUxAPObjectPageHeaderStickied",s);if(!this._bStickyAnchorBar&&s){this._$anchorBar.css("height",this.iAnchorBarHeight).children().appendTo(this._$stickyAnchorBar);this._bStickyAnchorBar=true;this._$headerContent.css("overflow","hidden");this.fireToggleAnchorBar({fixed:true});if(this.iHeaderTitleHeight!=this.iHeaderTitleHeightStickied){this._adjustHeaderBackgroundSize()}}else if(this._bStickyAnchorBar&&!s){this._$anchorBar.css("height","auto").append(this._$stickyAnchorBar.children());this._bStickyAnchorBar=false;this._$headerContent.css("overflow","inherit");this.fireToggleAnchorBar({fixed:false})}};
sap.uxap.ObjectPageLayout.prototype.getScrollDelegate=function(){return this._oScroller};
sap.uxap.ObjectPageLayout.prototype.setHeaderTitle=function(h,s){h.addEventDelegate({onAfterRendering:jQuery.proxy(this._adjustHeaderHeights,this)});return this.setAggregation("headerTitle",h,s)};
sap.uxap.ObjectPageLayout.prototype._adjustHeaderBackgroundSize=function(){var h=this.getHeaderTitle();if(h&&h.getHeaderDesign()=="Dark"){this.iTotalHeaderSize=this.iHeaderTitleHeight+this.iHeaderContentHeight;h.$().css("background-size","100% "+this.iTotalHeaderSize+"px");this._$headerContent.css("background-size","100% "+this.iTotalHeaderSize+"px");this._adjustHeaderTitleBackgroundPosition(0,false)}};
sap.uxap.ObjectPageLayout.prototype._adjustHeaderTitleBackgroundPosition=function(s){var h=this.getHeaderTitle();if(h&&h.getHeaderDesign()=="Dark"){if(this._bStickyAnchorBar){h.$().css("background-position","0px "+((this.iTotalHeaderSize-this.iHeaderTitleHeightStickied)*-1)+"px")}else{h.$().css("background-position","0px "+(this.iHeaderTitleHeight+this.iHeaderContentHeight-this.iTotalHeaderSize-s)+"px")}}};
sap.uxap.ObjectPageLayout.prototype._adjustHeaderHeights=function(){if(this._$headerTitle.length>0){var $=this._$headerTitle.clone();this.iHeaderContentHeight=this._$headerContent.height();this.iAnchorBarHeight=this._$anchorBar.height();$.css({left:"-10000px",top:"-10000px",width:this._$headerTitle.width()+"px"});if(this._bStickyAnchorBar){this.iHeaderTitleHeightStickied=this._$headerTitle.height()-this.iAnchorBarHeight;$.removeClass("sapUxAPObjectPageHeaderStickied");$.appendTo(sap.ui.getCore().getStaticAreaRef());this.iHeaderTitleHeight=$.is(":visible")?$.height()-this.iAnchorBarHeight:0}else{this.iHeaderTitleHeight=this._$headerTitle.is(":visible")?this._$headerTitle.height():0;$.addClass("sapUxAPObjectPageHeaderStickied");$.appendTo(sap.ui.getCore().getStaticAreaRef());this.iHeaderTitleHeightStickied=$.height()}$.remove();this._$opWrapper.css("padding-top",this.iHeaderTitleHeight);this._adjustHeaderBackgroundSize();jQuery.sap.log.info("ObjectPageLayout :: adjustHeaderHeight","headerTitleHeight: "+this.iHeaderTitleHeight+" - headerTitleStickiedHeight: "+this.iHeaderTitleHeightStickied+" - headerContentHeight: "+this.iHeaderContentHeight)}else{jQuery.sap.log.debug("ObjectPageLayout :: adjustHeaderHeight","skipped as the objectPageLayout is being rendered")}};
sap.uxap.ObjectPageLayout.prototype._getLayoutDataForControl=function(c){var l=c.getLayoutData();if(!l){return undefined}else if(l instanceof sap.uxap.ObjectPageHeaderLayoutData){return l}else if(l.getMetadata().getName()=="sap.ui.core.VariantLayoutData"){var L=l.getMultipleLayoutData();for(var i=0;i<L.length;i++){var o=L[i];if(o instanceof sap.uxap.ObjectPageHeaderLayoutData){return o}}}return undefined};
sap.uxap.ObjectPageLayout.prototype._getHeaderDesign=function(){var h=this.getHeaderTitle();var d=sap.uxap.ObjectPageHeaderDesign.Light;if(h!=null){d=h.getHeaderDesign()}return d};
